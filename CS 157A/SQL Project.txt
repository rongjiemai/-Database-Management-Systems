Refer to the address, store, staff, and customer tables of the Sakila database. In this lab, these tables initially have the same columns as in Sakila. Implement a new strong entity phone, as shown in the following diagram: The diagram has four entities and three relationships. The entities are phone, store, staff, and customer. Phone has attributes phone_id R U, country_code R, phone_number R, and phone_type. Store, staff, and customer have no attributes. The relationships are store-has-phone, staff-has-phone, and customer-has-phone. All relationships have cardinality one-one maximum and zero-zero minimum. The diagram uses Sakila naming conventions. Follow the Sakila conventions for your table and column names: All lower case Underscore separator between root and suffix Foreign keys have the same name as referenced primary key Implement the diagram in three steps: Step 1. Remove the phone column from address. This column is replaced by the new strong entity. Step 2. Implement the strong entity as a new phone table. Specify data types VARCHAR(12) for phone_type and INTEGER UNSIGNED for other columns. Specify a suitable primary key and NOT NULL constraints according to the diagram. Step 3. Implement the has relationships as foreign keys in customer, staff, and store. Specify UNIQUE constraints according to the diagram. Specify SET NULL for delete rules and CASCADE for update rules, as follows: ALTER TABLE customer ADD FOREIGN KEY (phone_id) REFERENCES phone(phone_id) ON DELETE SET NULL ON UPDATE CASCADE;






-- Step 1) Remove the old column from address
ALTER TABLE address
  DROP COLUMN phone;

-- Step 2) Strong entity: phone
--  - phone_id (PK, REQUIRED)
--  - country_code (REQUIRED)
--  - phone_number (REQUIRED)
--  - phone_type (optional)
CREATE TABLE phone (
  phone_id     INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  country_code INTEGER UNSIGNED NOT NULL,
  phone_number INTEGER UNSIGNED NOT NULL,
  phone_type   VARCHAR(12),
  PRIMARY KEY (phone_id)
) ENGINE=InnoDB;

-- Step 3) has-relationships (one-to-one, optional on both sides)
-- Add phone_id to each table, make the column UNIQUE, and add FK with
-- ON DELETE SET NULL and ON UPDATE CASCADE

ALTER TABLE customer
  ADD COLUMN phone_id INTEGER UNSIGNED NULL,
  ADD UNIQUE (phone_id),
  ADD FOREIGN KEY (phone_id)
    REFERENCES phone (phone_id)
    ON DELETE SET NULL
    ON UPDATE CASCADE;

ALTER TABLE staff
  ADD COLUMN phone_id INTEGER UNSIGNED NULL,
  ADD UNIQUE (phone_id),
  ADD FOREIGN KEY (phone_id)
    REFERENCES phone (phone_id)
    ON DELETE SET NULL
    ON UPDATE CASCADE;

ALTER TABLE store
  ADD COLUMN phone_id INTEGER UNSIGNED NULL,
  ADD UNIQUE (phone_id),
  ADD FOREIGN KEY (phone_id)
    REFERENCES phone (phone_id)
    ON DELETE SET NULL
    ON UPDATE CASCADE;

